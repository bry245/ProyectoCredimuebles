@model IEnumerable<CrediV1_Prueba.Models.Proveedor>
@{
	ViewData["Title"] = "ListadoProveedor";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">

	<div class="container mt-4">
		<a href="@Url.Action("AgregarProveedor","Proveedor")" class="btn" type="submit" id="button-addon2"> <i class="">Agregar Proveedor</i>  </a>
		<div class="row justify-content-end">
			<div class="col-md-6">
				<form action="#" method="GET" class="form-inline">
					<div class="input-group">
						<input type="text" class="form-control" placeholder="Buscar..." aria-label="Buscar" aria-describedby="button-addon2">
						<div class="input-group-append">
						</div>
						<button class="btn" type="submit" id="button-addon2"> <i class=" fa fa-search"></i> </button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<div class="container mt-4">
		<table class="table table-hover" style="text-align:center">
			<thead>
				<tr>
					<th>Nombre del Proveedor</th>
					<th>telefono</th>
					<th>Dirección</th>
					<th>Correo Electrónico</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var proveedor in @Model)
				{
					<tr>
						<td>@proveedor.nombre</td>
						<td>@proveedor.telefono</td>
						<td>@proveedor.direccion</td>
						<td>@proveedor.correo</td>
						<td style="text-align:center">
							<button class="btn btn-danger" data-toggle="modal" id="confirmButtonInactivar">Inactivar</button>
							<a class="btn btn-danger" asp-controller="Proveedor" asp-action="EditarProveedor" asp-route-Proveedor="@proveedor.idProveedor">Editar</a>
						</td>
					</tr>
				}

			</tbody>
		</table>
	</div>
	<nav aria-label="Page navigation example" style="background-color:white">
		<ul class="pagination justify-content-center" style="background-color:#dce5e4">
			<li class="page-item disabled">
				<a class="page-link" href="#" tabindex="-1" aria-disabled="true">Anterior</a>
			</li>
			<li class="page-item"><a class="page-link" href="#">1</a></li>
			<li class="page-item"><a class="page-link" href="#">2</a></li>
			<li class="page-item"><a class="page-link" href="#">3</a></li>
			<li class="page-item">
				<a class="page-link" href="#">Siguiente</a>
			</li>
		</ul>
	</nav>

</div>

<script>

	document.getElementById('confirmButtonInactivar').addEventListener('click', function () {

		const email = document.getElementById('email').value;
		// Muestra una SweetAlert con las opciones de confirmar o cancelar
		Swal.fire({
			title: '¿Estás seguro?',
			text: "¡No podrás revertir esto!",
			icon: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#0d6efd',
			cancelButtonColor: '#c31e1e',
			confirmButtonText: 'Sí, inactivar usuario',
			cancelButtonText: 'Cancelar'
		}).then((result) => {
			// Si el usuario confirma, puedes ejecutar la acción aquí
			if (result.isConfirmed) {

				try {
					const response = await fetch('@Url.Action("GuardarEditarProveedor", "Proveedor")', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify(data)
					});

					if (response.ok) {
						Swal.fire({
							icon: 'success',
							title: 'Proveedor actualizado',
							text: 'El proveedor ha sido actualizado correctamente.'
						}).then(() => {
							window.location.href = '@Url.Action("ListadoProveedor", "Inventario")';
						});
					} else {
						Swal.fire({
							icon: 'error',
							title: 'Error',
							text: 'Hubo un problema al actualizar el proveedor.'
						});
					}
				} catch (error) {
					Swal.fire({
						icon: 'error',
						title: 'Error',
						text: 'Hubo un problema al actualizar el proveedor.'
					});
				} ``
			}
		})
	});

</script>